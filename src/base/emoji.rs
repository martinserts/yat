use std::collections::HashSet;

use unicode_normalization_alignments::char::is_combining_mark;

const EMOJI: [&str; 452] = [
    "😂", "😇", "🙃", "😍", "😜", "😘", "🤓", "😎", "😏", "🥺", "😢", "🤯", "😱", "🤔", "😶", "😵",
    "🤐", "🤢", "🤧", "😷", "🤕", "🤑", "🤠", "😈", "🤡", "💩", "👻", "☠️", "👽", "👾", "🤖", "🎃",
    "💪", "💋", "💄", "👂", "👃", "👣", "👁️", "👀", "🧠", "👶", "👏", "🤝", "🙌", "👍", "👎", "✊",
    "✌️", "🤘", "👌", "👉", "👋", "✍️", "🙏", "💅", "🤳", "💃", "👕", "👖", "👗", "👙", "👘", "👠",
    "👢", "👞", "👟", "🎩", "🧢", "👒", "🎓", "👑", "💍", "👛", "💼", "🎒", "🐶", "🐱", "🐭", "🐰",
    "🦊", "🐻", "🐼", "🐮", "🐨", "🐯", "🦁", "🐷", "🐽", "🐸", "🐵", "🙈", "🐔", "🐧", "🐣", "🦆",
    "🦅", "🦉", "🦇", "🐺", "🐗", "🐴", "🦄", "🐝", "🐛", "🦋", "🐌", "🐞", "🐜", "🕷️", "🕸️", "🦂",
    "🐢", "🐍", "🦎", "🦖", "🐊", "🦓", "🦍", "🦏", "🐙", "🦀", "🐬", "🐋", "🦈", "🐘", "🐪", "🐃",
    "🐑", "🐐", "🦌", "🦃", "🐀", "🐾", "🐉", "🌵", "🌲", "🌴", "🍀", "🎋", "🍁", "🍄", "🐚", "💐",
    "🌹", "🌸", "🌻", "🌕", "🌙", "⭐", "✨", "⚡", "☄️", "💥", "🔥", "🌪️", "🌈", "☀️", "☁️", "❄️",
    "⛄", "💨", "💦", "🌊", "🍎", "🍐", "🍊", "🍋", "🍌", "🍉", "🍇", "🍓", "🍈", "🍒", "🍑", "🍍",
    "🥝", "🍆", "🥑", "🥒", "🌶️", "🌽", "🥕", "🥔", "🥐", "🍞", "🧀", "🥚", "🍳", "🥞", "🥓", "🍗",
    "🌭", "🍔", "🍟", "🍕", "🥙", "🌮", "🌯", "🥗", "🍝", "🍜", "🍣", "🍱", "🍤", "🍚", "🍘", "🍥",
    "🍡", "🍦", "🎂", "🍭", "🍬", "🍫", "🍿", "🍩", "🍪", "🥜", "🌰", "🍯", "🥛", "🍼", "☕", "🍵",
    "🍶", "🍺", "🍷", "🥃", "🍸", "🍾", "🥄", "🍽️", "⚽", "🏀", "🏈", "⚾", "🎾", "🏐", "🎱", "🏓",
    "🏸", "🏒", "🏏", "🥅", "⛳", "🏹", "🎣", "🥊", "🥋", "🎽", "⛸️", "🎿", "🏆", "🎖️", "🎟️", "🎪",
    "🎭", "🎨", "🎬", "🎤", "🎧", "🎼", "🎹", "🥁", "🎷", "🎺", "🎸", "🎻", "🎲", "♟️", "🎯", "🎳",
    "🎮", "🎰", "🚗", "🏎️", "🚓", "🚑", "🚒", "🚚", "🚜", "🚲", "🛵", "🏍️", "🚨", "🚠", "🚂", "✈️",
    "💺", "🚀", "🛸", "🚁", "🛶", "⛵", "🚢", "⚓", "🚧", "🚦", "🗺️", "🗿", "🗽", "🗼", "🏰", "🏯",
    "🏟️", "🎡", "🎢", "🎠", "🏖️", "⛰️", "🏕️", "🏠", "🏭", "🏥", "🏦", "🏛️", "⛪", "🕌", "🕍", "🗾",
    "⌚", "📱", "💻", "🖨️", "🕹️", "💾", "📷", "🎥", "📟", "📺", "📻", "🎛️", "⏰", "⌛", "📡", "🔋",
    "🔌", "💡", "🔦", "🕯️", "🛢️", "💵", "💰", "💳", "💎", "⚖️", "🔧", "🔨", "🔩", "⚙️", "⛓️", "🔫",
    "💣", "🔪", "🗡️", "🛡️", "🚬", "⚰️", "🏺", "🔮", "📿", "💈", "🔭", "🔬", "🕳️", "💊", "💉", "🚽",
    "🚰", "🚿", "🛋️", "🔑", "🚪", "🗄️", "📎", "📏", "📐", "📌", "✂️", "🗑️", "🖼️", "🛍️", "🛒", "🎁", "🎈",
    "🎏", "🎀", "🎉", "🎎", "🏮", "🎐", "✉️", "📦", "📜", "📈", "🗞️", "📓", "📖", "🖍️", "✏️", "🔒",
    "❤️", "💔", "✝️", "☪️", "🕉️", "☸️", "✡️", "🕎", "☯️", "☦️", "♈", "♉", "♊", "♋", "♌", "♍", "♎",
    "♏", "♐", "♑", "♒", "♓", "🆔", "♾️", "⚛️", "☢️", "🆚", "🆘", "🚫", "🚭", "💯", "❗", "❓",
    "⚠️", "🔱", "⚜️", "♻️", "🏧", "🆒", "🆕", "🆓", "🆙", "🎵", "➕", "💱", "🔔", "♠️", "♣️", "🃏",
    "🀄", "🏁",
];

pub fn drop_combining_marks(s: impl Iterator<Item = char>) -> impl Iterator<Item = char> {
    s.filter(|c| !is_combining_mark(*c))
}

fn get_emoji_char(emoji: &str) -> Option<char> {
    drop_combining_marks(emoji.chars()).next()
}

lazy_static! {
    static ref EMOJI_SET: HashSet<char> =
        HashSet::from_iter(EMOJI.into_iter().filter_map(get_emoji_char));
}

pub fn is_valid_emoji(emoji: char) -> bool {
    EMOJI_SET.contains(&emoji)
}
